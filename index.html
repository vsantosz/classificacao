<!DOCTYPE html>
<html lang="pt-BR" class="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

  <!-- PWA Setup -->
  <meta name="theme-color" content="#4f46e5" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0f172a" media="(prefers-color-scheme: dark)">
  <meta name="description" content="Painel de Intelig√™ncia para Classifica√ß√£o do CNU Bloco 7 - Justi√ßa e Defesa">
  <meta name="author" content="Vicenzo Soares dos Santos">

  <!-- iOS Support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Painel CNU">
  <!-- Icons & Social -->
  <link rel="icon" type="image/png" href="assets/favicon.png">
  <link rel="apple-touch-icon" href="assets/favicon.png">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Painel CNU - Bloco 7">
  <meta property="og:description" content="Painel Avan√ßado de Classifica√ß√£o e Intelig√™ncia de Dados.">
  <meta property="og:image" content="assets/og-image.png">
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:image" content="assets/og-image.png">

  <title>Painel CNU - Bloco 7</title>

  <!-- Manifest Placeholder -->
  <link rel="manifest" id="manifest-placeholder">

  <!-- Bibliotecas -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- HTML2Canvas para gerar imagem -->
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <!-- Fontes -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&display=swap"
    rel="stylesheet">

  <script>
    // --- CONFIGURA√á√ÉO GERAL ---
    const SYSTEM_API_KEY = "AIzaSyB3-Ejl-N27DPueARZmaXrUVFgw8hCbXnQ";

    // --- MANIFEST DIN√ÇMICO ---
    const manifestData = {
      "name": "Painel CNU - Bloco 7",
      "short_name": "CNU B7",
      "start_url": ".",
      "display": "standalone",
      "background_color": "#ffffff",
      "theme_color": "#4f46e5",
      "orientation": "portrait",
      "icons": [
        { "src": "https://cdn-icons-png.flaticon.com/512/2910/2910768.png", "sizes": "192x192", "type": "image/png" },
        { "src": "https://cdn-icons-png.flaticon.com/512/2910/2910768.png", "sizes": "512x512", "type": "image/png" }
      ]
    };

    window.addEventListener('load', () => {
      const blobManifest = new Blob([JSON.stringify(manifestData)], { type: 'application/json' });
      const ph = document.querySelector('#manifest-placeholder');
      if (ph) ph.setAttribute('href', URL.createObjectURL(blobManifest));
    });

    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: { slate: { 850: '#1e293b', 900: '#0f172a', 950: '#020617' } },
          borderRadius: { '4xl': '2rem' },
          animation: { 'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite' }
        }
      }
    };
  </script>

  <link rel="stylesheet" href="css/styles.css">
</head>

<body class="text-slate-800 bg-slate-50 dark:bg-[#050505] dark:text-[#e5e5e5] transition-colors duration-300">

  <!-- INTRO SPLASH SCREEN -->
  <div id="introScreen"
    class="fixed inset-0 z-[100] bg-slate-50 dark:bg-[#050505] flex flex-col items-center justify-center p-6 text-center animate-fade-in overflow-y-auto">
    <div
      class="max-w-md w-full bg-white dark:bg-[#121212] rounded-3xl shadow-2xl p-8 border border-slate-100 dark:border-[#262626] relative overflow-hidden my-auto">
      <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"></div>

      <div class="absolute top-4 right-4">
        <button onclick="toggleDarkMode()"
          class="h-8 w-8 flex items-center justify-center rounded-full bg-slate-100 dark:bg-[#1a1a1a] text-slate-500 dark:text-yellow-400 hover:bg-slate-200 transition-colors">
          <i class="fa-solid fa-moon dark:hidden"></i>
          <i class="fa-solid fa-sun hidden dark:block"></i>
        </button>
      </div>

      <div
        class="w-20 h-20 bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 text-white rounded-3xl flex items-center justify-center text-3xl shadow-lg mb-6 mx-auto transform hover:rotate-3 transition-transform ring-4 ring-white dark:ring-[#262626]">
        <i class="fa-solid fa-chart-line"></i>
      </div>

      <h1 class="text-2xl font-black text-slate-800 dark:text-white mb-1">Painel CNU <span class="text-indigo-600">Bloco
          7</span></h1>
      <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-6">Justi√ßa e Defesa</p>

      <div
        class="text-xs text-slate-500 dark:text-[#a3a3a3] space-y-4 mb-8 text-left bg-slate-50 dark:bg-[#1a1a1a] p-5 rounded-xl border border-slate-100 dark:border-[#262626] max-h-60 overflow-y-auto custom-scroll shadow-inner">
        <h3
          class="font-bold text-slate-700 dark:text-slate-200 uppercase text-[10px] tracking-wider mb-2 border-b border-slate-200 dark:border-[#333] pb-1">
          <i class="fa-solid fa-scale-balanced mr-1"></i> Termos de Uso e Isen√ß√£o
        </h3>
        <p><strong>1. Ferramenta N√£o Oficial:</strong> Este painel √© uma aplica√ß√£o independente desenvolvida para fins
          estritamente <strong>estat√≠sticos e de simula√ß√£o</strong>. N√£o possui qualquer v√≠nculo com o Governo Federal,
          MGI ou a Banca Examinadora (Cesgranrio).</p>
        <p><strong>2. Natureza dos Dados:</strong> As classifica√ß√µes e notas aqui exibidas s√£o estimativas baseadas em
          dados p√∫blicos preliminares e/ou inser√ß√µes manuais. Elas <strong>N√ÉO</strong> substituem as publica√ß√µes
          oficiais e n√£o possuem validade legal.</p>
        <p><strong>3. Isen√ß√£o de Responsabilidade:</strong> O desenvolvedor e os colaboradores n√£o se responsabilizam
          por decis√µes tomadas com base nestas proje√ß√µes, nem por eventuais diverg√™ncias em rela√ß√£o ao resultado final
          oficial. O uso desta ferramenta √© de sua inteira responsabilidade.</p>
        <div
          class="flex items-center gap-2 p-2 bg-indigo-50 dark:bg-indigo-900/10 rounded border border-indigo-100 dark:border-indigo-900/30">
          <i class="fa-solid fa-calendar-check text-indigo-500"></i>
          <span class="font-semibold text-indigo-700 dark:text-indigo-400">Resultado Oficial previsto para:
            20/02/2026</span>
        </div>
      </div>

      <button onclick="window.acceptDisclaimer()"
        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-500/30 transition-all transform active:scale-95 flex items-center justify-center gap-2 mb-6">
        <span>Concordar e Acessar</span> <i class="fa-solid fa-arrow-right"></i>
      </button>

      <div class="pt-4 border-t border-slate-100 dark:border-[#262626]">
        <p class="text-[10px] text-slate-400 mb-1">Criado por <strong>Vicenzo Soares dos Santos</strong> em 24/01/2026
        </p>
        <p class="text-[10px] text-slate-400">√öltima atualiza√ß√£o: <span id="lastUpdateDate"></span></p>

        <a href="https://vsantos.adv.br/" target="_blank"
          class="inline-flex items-center gap-2 mt-3 text-[10px] text-slate-400 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors font-medium border border-slate-200 dark:border-slate-700 px-3 py-1.5 rounded-full hover:bg-slate-50 dark:hover:bg-slate-800">
          <i class="fa-solid fa-scale-balanced"></i> Apoio Jur√≠dico: vsantos.adv.br
        </a>
      </div>
    </div>
  </div>

  <!-- DONATION POPUP (one-time) -->
  <div id="donationPopup" class="fixed inset-0 z-[99] hidden flex items-center justify-center p-6"
    style="background: rgba(0,0,0,0.5); backdrop-filter: blur(4px);">
    <div
      class="max-w-sm w-full bg-white dark:bg-[#121212] rounded-2xl shadow-2xl p-6 border border-slate-100 dark:border-[#262626] relative animate-fade-in">
      <button onclick="closeDonation()"
        class="absolute top-3 right-3 h-8 w-8 flex items-center justify-center rounded-full bg-slate-100 dark:bg-[#1a1a1a] text-slate-400 hover:text-slate-600 transition-colors">
        <i class="fa-solid fa-times"></i>
      </button>
      <div class="text-center">
        <div
          class="w-14 h-14 bg-gradient-to-br from-emerald-400 to-emerald-600 text-white rounded-2xl flex items-center justify-center text-2xl shadow-lg mx-auto mb-4">
          <i class="fa-solid fa-heart"></i>
        </div>
        <h3 class="text-lg font-black text-slate-800 dark:text-white mb-1">Apoie este projeto! üíö</h3>
        <p class="text-xs text-slate-500 dark:text-[#a3a3a3] mb-4 leading-relaxed">
          Este painel √© <strong>100% gratuito</strong> e feito com dedica√ß√£o para ajudar a comunidade do CNU Bloco 7.
          Se ele te ajudou de alguma forma, considere fazer uma contribui√ß√£o volunt√°ria via PIX. Qualquer valor √©
          bem-vindo! üôè
        </p>
        <div class="bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-[#262626] rounded-xl p-4 mb-4">
          <p class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2">Chave PIX (Celular)</p>
          <div class="flex items-center justify-center gap-2">
            <span class="text-lg font-black text-emerald-600 dark:text-emerald-400 font-mono tracking-wide"
              id="pixKey">51983336509</span>
            <button onclick="copyPix()" id="pixCopyBtn"
              class="h-8 w-8 flex items-center justify-center rounded-lg bg-emerald-50 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 hover:bg-emerald-100 transition-colors"
              title="Copiar">
              <i class="fa-solid fa-copy text-sm"></i>
            </button>
          </div>
          <p id="pixCopied" class="text-[10px] text-emerald-500 font-bold mt-1 hidden">‚úì Copiado!</p>
        </div>
        <p class="text-[10px] text-slate-400 italic mb-4">A doa√ß√£o √© totalmente opcional. Este aviso n√£o aparecer√°
          novamente.</p>
        <div class="flex gap-2">
          <button onclick="closeDonation()"
            class="flex-1 py-3 rounded-xl text-xs font-bold text-slate-500 bg-slate-100 dark:bg-[#1a1a1a] hover:bg-slate-200 dark:hover:bg-[#262626] transition-colors">
            Fechar
          </button>
          <button onclick="copyPix(); closeDonation()"
            class="flex-1 py-3 rounded-xl text-xs font-bold text-white bg-emerald-600 hover:bg-emerald-700 transition-colors shadow-lg shadow-emerald-500/30 flex items-center justify-center gap-2">
            <i class="fa-solid fa-copy"></i> Copiar PIX
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- MAIN APP LAYOUT -->
  <div class="layout-container opacity-0 transition-opacity duration-700" id="mainLayout">

    <!-- Header -->
    <header
      class="bg-white dark:bg-[#121212] border-b border-slate-200 dark:border-[#262626] flex-none z-50 flex items-center justify-between px-6 lg:px-8 shadow-sm relative transition-all duration-300">

      <div class="flex items-center gap-4 lg:gap-5 overflow-hidden header-title-container py-1">
        <div
          class="bg-gradient-to-br from-indigo-600 to-indigo-800 text-white p-3 rounded-4xl shadow-xl flex-none transform transition hover:scale-105 hidden lg:block">
          <i class="fa-solid fa-chart-simple text-lg"></i>
        </div>
        <div class="flex-none">
          <h1
            class="font-bold text-slate-900 dark:text-white uppercase tracking-tight text-xs lg:text-sm leading-tight flex flex-col lg:flex-row lg:items-center gap-1">
            <span>Painel CNU</span>
            <span class="hidden lg:inline text-slate-300 dark:text-slate-600 mx-1">|</span>
            <span
              class="text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-900/30 px-2 py-0.5 rounded text-[10px] lg:text-xs">Bloco
              7</span>
          </h1>
          <p
            class="text-[10px] text-slate-500 dark:text-[#a3a3a3] font-semibold uppercase tracking-wider mt-0.5 hidden sm:block">
            Justi√ßa e Defesa</p>
        </div>
      </div>

      <!-- Mobile Hamburger Button -->
      <div class="header-hamburger items-center gap-3">
        <button onclick="window.openStatsModal()"
          class="h-9 w-9 flex items-center justify-center rounded-lg bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400">
          <i class="fa-solid fa-chart-pie"></i>
        </button>
        <button onclick="window.openStatsModal()"
          class="h-9 w-9 flex items-center justify-center rounded-lg bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400">
          <i class="fa-solid fa-chart-pie"></i>
        </button>
        <button onclick="toggleAI()"
          class="h-9 w-9 flex items-center justify-center rounded-lg bg-gradient-to-r from-violet-500 to-fuchsia-500 text-white shadow-md hover:shadow-lg transition-all animate-pulse-slow">
          <i class="fa-solid fa-wand-magic-sparkles"></i>
        </button>
        <button onclick="toggleMobileMenu()"
          class="h-9 w-9 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-[#1a1a1a] text-slate-600 dark:text-[#d4d4d4] hover:bg-slate-200 dark:hover:bg-[#262626] transition-colors">
          <i class="fa-solid fa-bars text-lg"></i>
        </button>
      </div>

      <!-- Desktop Actions -->
      <div class="header-actions-desktop items-center gap-2 lg:gap-3">
        <!-- AI Assistant -->
        <button onclick="toggleAI()"
          class="h-9 w-9 flex items-center justify-center rounded-lg bg-gradient-to-r from-violet-500 to-fuchsia-500 text-white shadow-md hover:shadow-lg hover:scale-105 transition-all animate-pulse-slow"
          title="IA Insights">
          <i class="fa-solid fa-wand-magic-sparkles"></i>
        </button>

        <button onclick="window.openStatsModal()"
          class="h-9 w-9 flex items-center justify-center rounded-lg bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/50 transition-colors shadow-sm"
          title="Estat√≠sticas">
          <i class="fa-solid fa-chart-pie"></i>
        </button>

        <button onclick="toggleHelp()"
          class="h-9 w-9 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-[#1a1a1a] text-slate-500 hover:text-indigo-600 transition-colors"
          title="Ajuda">
          <i class="fa-solid fa-circle-question"></i>
        </button>

        <!-- Settings/Simulation -->
        <button onclick="toggleSettings()"
          class="h-9 w-9 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-[#1a1a1a] text-slate-500 dark:text-[#a3a3a3] hover:bg-indigo-100 dark:hover:bg-indigo-900/30 hover:text-indigo-600 transition-colors shadow-sm"
          title="Simulador de Vagas">
          <i class="fa-solid fa-gear"></i>
        </button>

        <!-- Comparison Mode Toggle -->
        <button id="compareModeBtn" onclick="toggleCompareMode()"
          class="h-9 px-3 hidden lg:flex items-center justify-center gap-2 rounded-lg bg-white dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-[#d4d4d4] hover:bg-indigo-50 dark:hover:bg-indigo-900/20 hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors shadow-sm text-xs font-bold uppercase">
          <i class="fa-solid fa-scale-balanced"></i> Comparar
        </button>

        <button id="installBtn"
          class="hidden h-9 px-3 items-center justify-center gap-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors shadow-sm font-bold text-xs uppercase animate-pulse">
          <i class="fa-solid fa-download"></i> <span class="hidden sm:inline">Instalar</span>
        </button>



        <button onclick="toggleDarkMode()"
          class="h-9 w-9 flex items-center justify-center rounded-lg bg-slate-100 dark:bg-[#1a1a1a] text-slate-600 dark:text-yellow-400 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors shadow-sm"
          title="Tema">
          <i class="fa-solid fa-moon dark:hidden"></i>
          <i class="fa-solid fa-sun hidden dark:block"></i>
        </button>

        <div class="w-px h-6 bg-slate-200 dark:bg-[#262626] mx-1 hidden sm:block"></div>

        <!-- Links -->
        <a href="https://conhecimento.fgv.br/cpnu2" target="_blank"
          class="h-9 px-3 flex items-center justify-center gap-2 bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800 rounded-lg text-indigo-700 dark:text-indigo-300 hover:bg-indigo-100 dark:hover:bg-indigo-900/40 transition-colors shadow-sm group"
          title="Edital">
          <i class="fa-solid fa-globe group-hover:scale-110 transition-transform"></i> <span
            class="hidden lg:inline text-xs font-bold">Edital</span>
        </a>
        <a href="https://inscricao-cpnu.conhecimento.fgv.br/" target="_blank"
          class="h-9 px-3 flex items-center justify-center gap-2 bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800 rounded-lg text-indigo-700 dark:text-indigo-300 hover:bg-indigo-100 dark:hover:bg-indigo-900/40 transition-colors shadow-sm group"
          title="Login">
          <i class="fa-solid fa-user-lock group-hover:scale-110 transition-transform"></i> <span
            class="hidden lg:inline text-xs font-bold">Login</span>
        </a>
        <a href="https://vsantos.adv.br/" target="_blank"
          class="h-9 px-2 flex items-center justify-center gap-1 rounded-lg text-slate-400 hover:text-indigo-600 dark:hover:text-indigo-400 hover:bg-slate-100 dark:hover:bg-slate-800 border border-transparent hover:border-slate-200 dark:hover:border-slate-700 transition-all group"
          title="VS Advocacia">
          <i class="fa-solid fa-scale-balanced text-sm group-hover:scale-110 transition-transform"></i>
        </a>

        <div class="w-px h-6 bg-slate-200 dark:bg-[#262626] mx-1 hidden sm:block"></div>

        <button onclick="shareApp()"
          class="h-9 w-9 flex items-center justify-center rounded-lg text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors"
          title="Compartilhar">
          <i class="fa-brands fa-whatsapp text-lg"></i>
        </button>

        <div id="statusBadge"
          class="hidden items-center gap-2 px-3 py-1.5 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 rounded-full border border-emerald-100 dark:border-emerald-800 text-[10px] font-bold uppercase transition-all shadow-sm">
          <span class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></span> <span id="dbCount">0</span>
        </div>



        <button onclick="clearData()"
          class="h-9 w-9 flex items-center justify-center text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"
          title="Sair">
          <i class="fa-solid fa-power-off"></i>
        </button>
      </div>
    </header>

    <!-- Mobile Menu Dropdown -->
    <div id="mobileMenu"
      class="hidden fixed top-16 left-0 w-full bg-white dark:bg-[#121212] border-b border-slate-200 dark:border-[#262626] z-40 flex-col p-4 shadow-xl animate-fade-in lg:hidden">
      <div class="grid grid-cols-2 gap-3 mb-4">
        <a href="https://conhecimento.fgv.br/cpnu2" target="_blank"
          class="h-10 flex items-center justify-center gap-2 bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800 rounded-lg text-indigo-700 dark:text-indigo-300 font-bold text-xs"><i
            class="fa-solid fa-globe"></i> Edital</a>
        <a href="https://inscricao-cpnu.conhecimento.fgv.br/" target="_blank"
          class="h-10 flex items-center justify-center gap-2 bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800 rounded-lg text-indigo-700 dark:text-indigo-300 font-bold text-xs"><i
            class="fa-solid fa-user-lock"></i> Login</a>
      </div>
      <div class="flex flex-col gap-3">
        <button onclick="toggleSettings(); toggleMobileMenu()"
          class="h-10 flex items-center gap-3 px-4 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 text-sm font-medium text-slate-600 dark:text-[#d4d4d4]">
          <i class="fa-solid fa-gear text-indigo-500 w-5"></i> Simulador de Vagas
        </button>
        <button onclick="toggleCompareMode(); toggleMobileMenu()"
          class="h-10 flex items-center gap-3 px-4 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 text-sm font-medium text-slate-600 dark:text-[#d4d4d4]">
          <i class="fa-solid fa-scale-balanced text-indigo-500 w-5"></i> Modo Compara√ß√£o
        </button>
        <button onclick="toggleDarkMode(); toggleMobileMenu()"
          class="h-10 flex items-center gap-3 px-4 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 text-sm font-medium text-slate-600 dark:text-[#d4d4d4]">
          <i class="fa-solid fa-moon text-indigo-500 w-5"></i> Alternar Tema
        </button>
        <button onclick="toggleCompactMode(); toggleMobileMenu()"
          class="h-10 flex items-center gap-3 px-4 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 text-sm font-medium text-slate-600 dark:text-[#d4d4d4]">
          <i class="fa-solid fa-compress text-indigo-500 w-5"></i> Modo Compacto
        </button>
        <button onclick="saveOfflineHTML(); toggleMobileMenu()"
          class="h-10 flex items-center gap-3 px-4 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 text-sm font-medium text-slate-600 dark:text-[#d4d4d4]">
          <i class="fa-solid fa-floppy-disk text-indigo-500 w-5"></i> Salvar Offline
        </button>
        <button onclick="shareApp(); toggleMobileMenu()"
          class="h-10 flex items-center gap-3 px-4 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 text-sm font-medium text-slate-600 dark:text-[#d4d4d4]">
          <i class="fa-brands fa-whatsapp text-green-500 w-5"></i> Compartilhar App
        </button>
        <button onclick="clearData()"
          class="h-10 flex items-center gap-3 px-4 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 text-sm font-medium text-red-500">
          <i class="fa-solid fa-power-off w-5"></i> Sair / Limpar Dados
        </button>
      </div>
    </div>

    <!-- Main -->
    <main
      class="flex-1 flex flex-col p-3 lg:p-6 gap-3 lg:gap-4 overflow-hidden relative bg-slate-50/50 dark:bg-[#050505] transition-colors duration-300">

      <!-- Comparison Floating Action Button (Mobile) -->
      <button id="fabCompare" onclick="executeComparison()"
        class="fixed bottom-24 right-6 z-50 h-14 w-14 bg-indigo-600 text-white rounded-full shadow-xl flex items-center justify-center transform scale-0 transition-transform duration-300">
        <i class="fa-solid fa-check-double text-xl"></i>
      </button>

      <!-- Scroll Buttons -->
      <div class="scroll-btn-group opacity-0 translate-y-10 pointer-events-none" id="scrollGroup">
        <button onclick="scrollToTop()" class="scroll-btn" title="Topo">
          <i class="fa-solid fa-arrow-up"></i>
        </button>
        <button onclick="scrollToBottom()" class="scroll-btn" title="Fim">
          <i class="fa-solid fa-arrow-down"></i>
        </button>
      </div>

      <!-- Upload -->
      <div id="uploadScreen"
        class="absolute inset-0 z-50 flex items-center justify-center bg-slate-100/90 dark:bg-[#121212]/90 backdrop-blur-sm p-4 transition-all duration-300">
        <div
          class="glass-panel w-full max-w-md overflow-hidden flex flex-col shadow-2xl animate-fade-in bg-white dark:bg-[#121212]">
          <div class="flex border-b border-slate-100 dark:border-[#262626]">
            <button onclick="switchTab('file')" id="tabFile"
              class="flex-1 py-4 text-xs font-bold uppercase tracking-wide text-indigo-600 border-b-2 border-indigo-600 bg-indigo-50/30 dark:bg-indigo-900/20">Arquivo
              .JSON</button>
            <button onclick="switchTab('text')" id="tabText"
              class="flex-1 py-4 text-xs font-bold uppercase tracking-wide text-slate-400 hover:text-indigo-600 transition-colors">Colar
              Texto</button>
          </div>
          <div id="panelFile" class="p-8 text-center flex flex-col items-center">
            <div
              class="w-16 h-16 bg-slate-50 dark:bg-[#1a1a1a] rounded-full flex items-center justify-center mb-4 shadow-inner">
              <i class="fa-solid fa-cloud-arrow-up text-2xl text-indigo-500"></i>
            </div>
            <h2 class="font-bold text-slate-800 dark:text-white text-lg mb-1">Carregar Dados</h2>
            <p class="text-slate-500 dark:text-[#a3a3a3] mb-6 text-xs px-4">Selecione o arquivo
              <code>resultado_oficial_v5.json</code>.
            </p>
            <label
              class="group relative w-full cursor-pointer bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3.5 px-4 rounded-xl shadow-lg transition-all text-xs uppercase flex items-center justify-center gap-2 overflow-hidden">
              <span class="relative z-10 flex items-center gap-2"><i class="fa-solid fa-folder-open"></i> Selecionar
                Arquivo</span>
              <input type="file" id="fileInput" accept=".json" class="hidden">
            </label>
            <div id="loadingUpload"
              class="hidden mt-4 text-indigo-600 dark:text-indigo-400 text-xs font-bold flex items-center gap-2"><i
                class="fa-solid fa-circle-notch fa-spin"></i> Processando...</div>
          </div>
          <div id="panelText" class="p-5 hidden flex-col gap-3">
            <p class="text-xs text-slate-500 dark:text-[#a3a3a3] font-medium">Cole o JSON abaixo:</p>
            <textarea id="jsonTextInput"
              class="w-full h-48 p-3 text-[10px] font-mono border border-slate-200 dark:border-slate-700 rounded-lg focus:border-indigo-500 outline-none resize-none bg-slate-50 dark:bg-[#050505] text-slate-600 dark:text-[#d4d4d4]"></textarea>
            <button onclick="loadFromText()"
              class="w-full bg-slate-800 dark:bg-indigo-600 hover:bg-slate-900 dark:hover:bg-indigo-700 text-white font-bold py-3.5 rounded-xl text-xs uppercase shadow transition-all flex items-center justify-center gap-2"><i
                class="fa-solid fa-bolt"></i> Carregar</button>
          </div>
        </div>
      </div>

      <!-- Dashboard -->
      <div id="dashboardScreen" class="hidden flex-col h-full gap-3 lg:gap-4">
        <!-- Filters -->
        <div
          class="glass-panel p-2.5 flex flex-col lg:flex-row items-center justify-between gap-3 flex-none z-20 bg-white dark:bg-[#121212] transition-colors duration-300">
          <div class="flex flex-col sm:flex-row items-center gap-2 w-full lg:w-auto">
            <div class="relative w-full sm:w-60 group">
              <label
                class="absolute -top-2 left-2 bg-white dark:bg-[#121212] px-1 text-[9px] font-bold text-indigo-600 dark:text-indigo-400 uppercase rounded z-10">Visualiza√ß√£o</label>
              <select id="viewFilter" onchange="updateView()"
                class="w-full h-10 pl-3 pr-8 bg-white dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 rounded-lg text-xs font-bold text-slate-700 dark:text-[#e5e5e5] outline-none focus:border-indigo-500 appearance-none shadow-sm cursor-pointer hover:border-indigo-300 dark:hover:border-indigo-600">
                <option value="Geral">üåç Classifica√ß√£o Geral</option>
                <option value="MEU">üë§ Meu Resultado</option>
                <option value="AC">üè¢ Ampla Concorr√™ncia</option>
                <option value="PN">‚úäüèø Pessoas Negras</option>
                <option value="PCD">‚ôø PCD</option>
                <option value="PI">üèπ Ind√≠genas</option>
                <option value="PQ">üè° Quilombolas</option>
                <option value="FAV">‚≠ê Meus Favoritos</option>
              </select>
              <i
                class="fa-solid fa-chevron-down absolute right-3 top-3.5 text-slate-400 text-xs pointer-events-none group-hover:text-indigo-500"></i>
            </div>
            <div
              class="flex items-center gap-2 bg-white dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 rounded-lg px-3 h-10 w-full sm:w-auto justify-between shadow-sm relative hover:border-indigo-300 transition-colors">
              <label
                class="absolute -top-2 left-2 bg-white dark:bg-[#121212] px-1 text-[9px] font-bold text-slate-400 dark:text-[#737373] uppercase rounded">Vagas
                AC</label>
              <input type="number" id="vagasInput"
                class="w-16 bg-transparent text-sm font-bold text-center text-indigo-700 dark:text-indigo-400 outline-none"
                value="161" onchange="updateVagasManual()">
            </div>
          </div>
          <div class="flex items-center gap-2 w-full lg:w-auto overflow-x-auto no-scrollbar">
            <div class="flex bg-slate-100 dark:bg-[#1a1a1a] p-1 rounded-lg">
              <button onclick="setQuickFilter('ALL')" id="qf-ALL"
                class="px-3 py-1.5 rounded text-[10px] font-bold uppercase bg-white dark:bg-[#262626] text-indigo-600 dark:text-indigo-300 shadow-sm">Todos</button>
              <button onclick="setQuickFilter('VAGA')" id="qf-VAGA"
                class="px-3 py-1.5 rounded text-[10px] font-bold uppercase text-slate-500 hover:text-emerald-600">Vaga</button>
              <button onclick="setQuickFilter('CR')" id="qf-CR"
                class="px-3 py-1.5 rounded text-[10px] font-bold uppercase text-slate-500 hover:text-sky-600">CR</button>
            </div>
            <div class="relative w-full lg:w-56 group flex-none">
              <input type="text" id="searchInput" oninput="handleSearchInput()" placeholder="Buscar..."
                class="w-full h-10 pl-9 pr-8 bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 rounded-lg text-xs outline-none focus:bg-white dark:focus:bg-slate-900 focus:border-indigo-500 dark:text-white transition-all shadow-sm">
              <i
                class="fa-solid fa-search absolute left-3 top-3.5 text-slate-400 text-xs group-focus-within:text-indigo-500"></i>
              <button id="clearSearchBtn" onclick="clearSearch()"
                class="absolute right-2 top-2.5 text-slate-400 hover:text-rose-500 hidden"><i
                  class="fa-solid fa-times-circle text-sm"></i></button>
            </div>
            <button id="btnToggleCharts" onclick="toggleSidebar()"
              class="lg:hidden h-10 w-10 flex-none flex items-center justify-center bg-white dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 text-slate-600 rounded-lg shadow-sm"><i
                class="fa-solid fa-chart-pie"></i></button>
            <button onclick="window.exportExcel()"
              class="h-10 w-10 flex-none flex items-center justify-center bg-emerald-600 text-white rounded-lg shadow-md hover:bg-emerald-700 transform active:scale-95"><i
                class="fa-solid fa-file-csv"></i></button>
            <button onclick="window.generatePDF()"
              class="h-10 w-10 flex-none flex items-center justify-center bg-rose-600 text-white rounded-lg shadow-md hover:bg-rose-700 transform active:scale-95"><i
                class="fa-solid fa-file-pdf"></i></button>
          </div>
        </div>
        <div id="myHeroDashboard"
          class="hidden glass-panel p-4 bg-gradient-to-r from-indigo-600 to-violet-600 text-white shadow-lg relative overflow-hidden shrink-0">
          <div class="absolute top-0 right-0 p-4 opacity-10 text-9xl transform translate-x-10 -translate-y-10"><i
              class="fa-solid fa-trophy"></i></div>

          <div class="relative z-10 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex items-center gap-4 w-full md:w-auto">
              <div
                class="h-12 w-12 rounded-full bg-white/20 flex items-center justify-center text-xl backdrop-blur-sm border border-white/30">
                <i class="fa-solid fa-user"></i>
              </div>
              <div>
                <p class="text-[10px] font-bold opacity-80 uppercase tracking-widest">Seu Desempenho</p>
                <h2 class="text-lg font-bold leading-tight" id="heroName">Nome do Usu√°rio</h2>
                <div class="flex items-center gap-2 mt-1">
                  <span class="bg-white/20 px-2 py-0.5 rounded text-[10px] font-bold backdrop-blur-md"
                    id="heroPos">#--</span>
                  <span class="bg-white text-indigo-600 px-2 py-0.5 rounded text-[10px] font-bold shadow-sm"
                    id="heroStatus">STATUS</span>
                </div>
              </div>
            </div>

            <div
              class="flex items-center gap-6 w-full md:w-auto bg-white/10 p-3 rounded-xl border border-white/10 backdrop-blur-sm justify-around md:justify-start">
              <div class="text-center">
                <p class="text-[9px] opacity-70 uppercase font-bold">Nota Final</p>
                <p class="text-xl font-black" id="heroScore">--</p>
              </div>
              <div class="w-px h-8 bg-white/20"></div>
              <div class="text-center">
                <p class="text-[9px] opacity-70 uppercase font-bold">Dist√¢ncia Vaga</p>
                <p class="text-sm font-bold text-emerald-300" id="heroGap">--</p>
              </div>
              <div class="w-px h-8 bg-white/20"></div>
              <button onclick="clearIdentity()"
                class="text-[9px] font-bold opacity-60 hover:opacity-100 hover:text-red-200 transition-opacity flex flex-col items-center">
                <i class="fa-solid fa-power-off text-sm mb-1"></i> Sair
              </button>
            </div>
          </div>
        </div>
        <!-- Grid -->
        <div class="flex-grow flex flex-col lg:flex-row gap-3 lg:gap-4 overflow-hidden min-h-0">
          <!-- Sidebar -->
          <div id="sidebarContainer"
            class="hidden lg:flex lg:w-[320px] flex-none flex-col gap-3 overflow-y-auto lg:pr-1 custom-scroll transition-all duration-300">
            <div class="grid grid-cols-2 gap-2 lg:gap-3">
              <div class="glass-panel p-3 border-l-4 border-emerald-500 bg-white dark:bg-[#121212] shadow-sm">
                <p class="text-[9px] text-emerald-700 dark:text-emerald-400 font-bold uppercase tracking-wider mb-1">
                  Corte Vaga</p>
                <div class="flex justify-between items-baseline">
                  <p class="text-xl font-black text-slate-800 dark:text-white font-mono" id="kpiCutVaga">--</p><span
                    class="text-[10px] font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/30 px-2 py-0.5 rounded"
                    id="posCutVaga">--</span>
                </div>
              </div>
              <div class="glass-panel p-3 border-l-4 border-sky-500 bg-white dark:bg-[#121212] shadow-sm">
                <p class="text-[9px] text-sky-700 dark:text-sky-400 font-bold uppercase tracking-wider mb-1">Corte CR
                </p>
                <div class="flex justify-between items-baseline">
                  <p class="text-xl font-black text-slate-800 dark:text-white font-mono" id="kpiCutCR">--</p><span
                    class="text-[10px] font-bold text-sky-600 dark:text-sky-400 bg-sky-50 dark:bg-sky-900/30 px-2 py-0.5 rounded"
                    id="posCutCR">--</span>
                </div>
              </div>
            </div>
            <div class="glass-panel p-3 bg-white dark:bg-[#121212] flex justify-between items-center shadow-sm">
              <div>
                <p class="text-[9px] text-slate-400 font-bold uppercase">Listados</p>
                <p class="text-lg font-black text-slate-700 dark:text-[#e5e5e5]" id="kpiListTotal">0</p>
              </div>
              <div class="text-right">
                <p class="text-[9px] text-slate-400 font-bold uppercase">Maior Nota</p>
                <p class="text-lg font-bold text-indigo-700 dark:text-indigo-400 font-mono" id="kpiMax">0.00</p>
              </div>
            </div>

            <!-- HISTOGRAMA & DISTRIBUI√á√ÉO (NOVO) -->
            <div class="glass-panel p-4 flex flex-col gap-6 bg-white dark:bg-[#121212] shadow-sm">
              <div>
                <h3 class="text-[10px] font-bold text-slate-400 uppercase mb-2 flex items-center gap-2"><i
                    class="fa-solid fa-chart-pie"></i> Situa√ß√£o</h3>
                <div class="h-48 w-full relative"><canvas id="statusChart"></canvas></div>
              </div>
              <hr class="border-slate-100 dark:border-[#262626]">
              <div>
                <h3 class="text-[10px] font-bold text-slate-400 uppercase mb-2 flex items-center gap-2"><i
                    class="fa-solid fa-chart-column"></i> Histograma de Notas</h3>
                <div class="h-60 w-full relative"><canvas id="scoreChart"></canvas></div>
              </div>
            </div>
          </div>

          <!-- Table -->
          <div
            class="flex-grow glass-panel flex flex-col overflow-hidden relative min-h-0 bg-white dark:bg-[#121212] shadow-sm transition-colors duration-300">
            <div
              class="px-4 py-3 border-b border-slate-100 dark:border-[#262626] bg-white dark:bg-[#121212] flex justify-between items-center flex-none sticky top-0 z-20">
              <div class="flex items-center gap-2">
                <div class="w-1 h-4 bg-indigo-600 rounded-full shadow-sm"></div>
                <h3 class="text-[10px] font-black text-slate-700 dark:text-[#e5e5e5] uppercase tracking-widest"
                  id="tableHeader">Classifica√ß√£o</h3>
              </div>
              <div class="flex items-center gap-2">
                <div id="cotasCounter" class="hidden sm:flex gap-1 text-[9px] font-bold text-slate-400"></div><span
                  class="text-[9px] font-bold text-slate-500 dark:text-[#a3a3a3] bg-slate-100 dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 px-2 py-0.5 rounded shadow-sm"
                  id="loadedCount">0</span>
              </div>
            </div>
            <div class="flex-grow overflow-y-auto relative custom-scroll bg-white dark:bg-[#121212]"
              id="tableContainer">
              <div id="emptyState"
                class="hidden absolute inset-0 flex flex-col items-center justify-center text-slate-300 dark:text-slate-600 h-full animate-fade-in">
                <i class="fa-solid fa-magnifying-glass text-4xl mb-3"></i>
                <p class="text-[10px] font-bold uppercase tracking-wide">Nenhum resultado encontrado</p>
              </div>
              <div class="mobile-scroll-x">
                <table class="w-full text-left border-collapse min-w-[600px] lg:min-w-0">
                  <thead
                    class="bg-slate-50 dark:bg-[#1a1a1a] sticky top-0 z-10 shadow-sm border-b border-slate-200 dark:border-slate-700">
                    <tr>
                      <!-- CHECKBOX FOR COMPARISON -->
                      <th class="hidden px-3 py-2.5 w-8 text-center" id="colCompare"><i
                          class="fa-solid fa-check-double text-slate-300 text-[10px]"></i></th>
                      <th
                        class="px-4 py-3 text-[10px] font-bold text-slate-500 dark:text-[#a3a3a3] uppercase w-12 text-center sortable-header"
                        onclick="sortData('pos_geral')">Pos <i class="fa-solid fa-sort ml-1 text-[9px]"></i></th>
                      <th
                        class="px-4 py-3 text-[10px] font-bold text-slate-500 dark:text-[#a3a3a3] uppercase w-12 text-center sortable-header"
                        onclick="sortData('geral_score')">Geral <i class="fa-solid fa-sort ml-1 text-[9px]"></i></th>
                      <th
                        class="px-4 py-3 text-[10px] font-bold text-slate-500 dark:text-[#a3a3a3] uppercase sortable-header"
                        onclick="sortData('name')">Candidato <i class="fa-solid fa-sort ml-1 text-[9px]"></i></th>
                      <th
                        class="px-4 py-3 text-[10px] font-bold text-slate-500 dark:text-[#a3a3a3] uppercase text-center w-24">
                        Situa√ß√£o</th>
                      <th
                        class="px-4 py-3 text-[10px] font-bold text-slate-500 dark:text-[#a3a3a3] uppercase text-right w-16 sortable-header"
                        title="Conhecimentos Espec√≠ficos" onclick="sortData('esp_score')">Esp <i
                          class="fa-solid fa-sort ml-1 text-[9px]"></i></th>
                      <th
                        class="px-4 py-3 text-[10px] font-bold text-slate-500 dark:text-[#a3a3a3] uppercase text-right w-16 sortable-header"
                        title="Prova Discursiva" onclick="sortData('disc_score')">Disc <i
                          class="fa-solid fa-sort ml-1 text-[9px]"></i></th>
                      <th
                        class="px-4 py-3 text-[10px] font-bold text-slate-500 dark:text-[#a3a3a3] uppercase text-right w-20 text-indigo-700 dark:text-indigo-400 sortable-header"
                        onclick="sortData('total_score')">Final <i class="fa-solid fa-sort ml-1 text-[9px]"></i></th>
                    </tr>
                  </thead>
                  <tbody id="tableBody"
                    class="divide-y divide-slate-50 dark:divide-slate-800 text-sm text-slate-600 dark:text-[#d4d4d4]">
                  </tbody>
                </table>
              </div>
              <div id="scrollSentinel" class="h-16 w-full flex justify-center items-center p-2"><i
                  class="fa-solid fa-spinner fa-spin text-indigo-400 hidden" id="spinnerIcon"></i></div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Floating Action Buttons -->
    <div class="scroll-btn-group opacity-0 translate-y-10 pointer-events-none" id="scrollGroup">
      <button onclick="scrollToTop()" class="scroll-btn" title="Topo">
        <i class="fa-solid fa-arrow-up"></i>
      </button>
      <button onclick="scrollToBottom()" class="scroll-btn" title="Fim">
        <i class="fa-solid fa-arrow-down"></i>
      </button>
    </div>

    <!-- Comparison Modal -->
    <div id="compareModal"
      class="fixed inset-0 z-[120] hidden flex items-center justify-center pointer-events-none p-4">
      <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity opacity-0 pointer-events-auto"
        onclick="closeCompare()" id="compareOverlay"></div>
      <div id="compareContent"
        class="glass-modal w-full max-w-2xl bg-white dark:bg-[#121212] p-6 rounded-2xl shadow-2xl transform scale-95 opacity-0 transition-all duration-300 pointer-events-auto relative">
        <button onclick="closeCompare()"
          class="absolute top-4 right-4 p-2 bg-slate-100 dark:bg-[#1a1a1a] rounded-full text-slate-400 hover:text-slate-800 z-10"><i
            class="fa-solid fa-times"></i></button>
        <h3
          class="text-lg font-bold text-slate-800 dark:text-white mb-6 border-b border-slate-100 dark:border-[#262626] pb-3">
          Comparativo
          Direto</h3>

        <!-- Chart Container -->
        <div class="mb-6 p-4 bg-slate-50 dark:bg-[#1a1a1a] rounded-xl border border-slate-100 dark:border-[#262626]">
          <canvas id="compareChart" height="200"></canvas>
        </div>

        <div class="grid grid-cols-2 gap-4 mb-6">
          <div id="comp1"
            class="text-center p-4 rounded-xl bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100"></div>
          <div id="comp2"
            class="text-center p-4 rounded-xl bg-fuchsia-50 dark:bg-fuchsia-900/20 border border-fuchsia-100"></div>
        </div>

        <div class="h-48 w-full"><canvas id="compareChart"></canvas></div>
      </div>
    </div>

    <!-- Settings Modal (New for Concurseiros - Absten√ß√£o) -->
    <div id="settingsModal"
      class="fixed inset-0 z-[120] hidden flex items-center justify-center pointer-events-none p-4">
      <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity opacity-0 pointer-events-auto"
        onclick="toggleSettings()" id="settingsOverlay"></div>
      <div id="settingsContent"
        class="glass-modal w-full max-w-sm bg-white dark:bg-[#121212] p-6 rounded-2xl shadow-2xl transform scale-95 opacity-0 transition-all duration-300 pointer-events-auto relative">
        <button onclick="toggleSettings()"
          class="absolute top-4 right-4 p-2 bg-slate-100 dark:bg-[#1a1a1a] rounded-full text-slate-400 hover:text-slate-800 z-10"><i
            class="fa-solid fa-times"></i></button>
        <h3 class="text-lg font-bold text-slate-800 dark:text-white mb-4 flex items-center gap-2"><i
            class="fa-solid fa-gear text-indigo-500"></i> Simulador Avan√ßado</h3>
        <p class="text-xs text-slate-500 mb-6">Simule cen√°rios de convoca√ß√£o (excedentes) e absten√ß√£o.</p>

        <div class="space-y-6">
          <!-- Abstention Slider -->
          <div>
            <div class="flex justify-between mb-2">
              <label class="text-xs font-bold text-slate-500 uppercase">Taxa de Absten√ß√£o/Desist√™ncia</label>
              <span id="abstentionVal" class="text-xs font-bold text-indigo-600">0%</span>
            </div>
            <input type="range" id="abstentionRange" min="0" max="50" step="5" value="0"
              class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer dark:bg-[#262626]"
              oninput="document.getElementById('abstentionVal').innerText = this.value + '%'">
          </div>

          <hr class="border-slate-100 dark:border-[#262626]">

          <div class="space-y-3">
            <p class="text-xs font-bold text-slate-400 uppercase">Vagas por Cota</p>
            <div class="flex items-center justify-between">
              <label class="text-xs font-bold text-slate-500">Ampla (AC)</label>
              <input type="number" id="set_ac"
                class="w-16 p-1.5 bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 rounded text-center font-bold text-indigo-600 dark:text-indigo-400">
            </div>
            <div class="flex items-center justify-between">
              <label class="text-xs font-bold text-slate-500">Pessoas Negras (PN)</label>
              <input type="number" id="set_pn"
                class="w-16 p-1.5 bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 rounded text-center font-bold text-orange-600 dark:text-orange-400">
            </div>
            <div class="flex items-center justify-between">
              <label class="text-xs font-bold text-slate-500">PCD</label>
              <input type="number" id="set_pcd"
                class="w-16 p-1.5 bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 rounded text-center font-bold text-blue-600 dark:text-blue-400">
            </div>
            <div class="flex items-center justify-between">
              <label class="text-xs font-bold text-slate-500">Ind√≠genas (PI)</label>
              <input type="number" id="set_pi"
                class="w-16 p-1.5 bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 rounded text-center font-bold text-emerald-600 dark:text-emerald-400">
            </div>
            <div class="flex items-center justify-between">
              <label class="text-xs font-bold text-slate-500">Quilombolas (PQ)</label>
              <input type="number" id="set_pq"
                class="w-16 p-1.5 bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-slate-700 rounded text-center font-bold text-purple-600 dark:text-purple-400">
            </div>
          </div>
        </div>

        <button onclick="applySettings()"
          class="w-full mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-xl shadow-lg transition-all">Aplicar
          Simula√ß√£o</button>
      </div>
    </div>

    <!-- AI Chat Modal -->
    <div id="aiModal" class="fixed inset-0 z-[110] hidden flex items-center justify-center pointer-events-none p-4">
      <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity opacity-0 pointer-events-auto"
        onclick="toggleAI()" id="aiOverlay"></div>
      <div id="aiContent"
        class="glass-modal w-full max-w-lg bg-white dark:bg-[#121212] p-0 rounded-2xl shadow-2xl transform scale-95 opacity-0 transition-all duration-300 pointer-events-auto flex flex-col h-[600px] max-h-[85vh] relative overflow-hidden">
        <div class="bg-gradient-to-r from-violet-600 to-fuchsia-600 p-4 flex justify-between items-center text-white">
          <div class="flex items-center gap-2"><i class="fa-solid fa-robot"></i>
            <h3 class="font-bold text-sm">Gemini Assistant</h3>
          </div>
          <button onclick="toggleAI()" class="hover:bg-white/20 p-1.5 rounded-full"><i
              class="fa-solid fa-times"></i></button>
        </div>
        <div id="aiChatArea"
          class="flex-1 overflow-y-auto p-4 custom-scroll bg-slate-50 dark:bg-[#050505] flex flex-col">
          <div class="ai-message bot shadow-sm border border-slate-200 dark:border-[#262626]">Ol√°! Sou sua IA
            especialista no CNU Bloco 7. J√° analisei os dados carregados. Pergunte algo como: "Qual a nota de corte para
            PN?" ou "Fa√ßa um resumo geral".</div>
        </div>
        <div class="p-3 bg-white dark:bg-[#121212] border-t border-slate-200 dark:border-[#262626]">
          <div id="apiKeyConfig" class="hidden mb-3 bg-slate-100 dark:bg-[#1a1a1a] p-2 rounded-lg">
            <label class="block text-[10px] font-bold text-slate-500 mb-1">API Key (Gemini):</label>
            <input type="password" id="apiKeyInput"
              class="w-full text-xs p-2 rounded border dark:bg-[#121212] dark:border-slate-600">
            <button onclick="saveApiKey()"
              class="mt-2 w-full bg-indigo-600 text-white text-xs py-1.5 rounded">Salvar</button>
          </div>
          <div class="relative">
            <input type="text" id="aiInput" placeholder="Digite sua pergunta..."
              class="w-full pl-4 pr-12 py-3 rounded-xl bg-slate-100 dark:bg-[#1a1a1a] border-none focus:ring-2 focus:ring-violet-500 dark:text-white text-sm shadow-inner"
              onkeypress="if(event.key === 'Enter') sendToAI()">
            <button onclick="sendToAI()"
              class="absolute right-2 top-2 p-1.5 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-colors shadow-sm"><i
                class="fa-solid fa-paper-plane text-xs"></i></button>
          </div>
        </div>
      </div>
    </div>

    <!-- MODAL DETAIL & RADAR & SNIPER -->
    <div id="detailModal" class="fixed inset-0 z-[100] hidden flex items-center justify-center pointer-events-none p-4">
      <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity opacity-0 pointer-events-auto"
        onclick="closeModal()" id="modalOverlay"></div>

      <div id="modalContent"
        class="glass-modal w-full max-w-4xl bg-white dark:bg-[#121212] p-6 rounded-2xl shadow-2xl transform scale-95 opacity-0 transition-all duration-200 pointer-events-auto flex flex-col md:flex-row gap-6 max-h-[90vh] overflow-hidden relative">

        <button onclick="closeModal()"
          class="absolute top-2 right-2 md:top-4 md:right-4 h-10 w-10 bg-slate-100 hover:bg-slate-200 dark:bg-[#1a1a1a] dark:hover:bg-[#262626] rounded-full text-slate-500 hover:text-rose-500 dark:text-slate-400 dark:hover:text-rose-400 transition-all z-20 shadow-md flex items-center justify-center active:scale-95 group">
          <i class="fa-solid fa-xmark text-lg group-hover:rotate-90 transition-transform"></i>
        </button>


        <div class="flex-1 flex flex-col gap-4 overflow-y-auto custom-scroll p-1 min-w-0">
          <div>
            <div class="flex items-center gap-2 mb-2">
              <span
                class="text-[10px] font-bold text-white bg-slate-800 dark:bg-[#262626] px-2 py-0.5 rounded uppercase tracking-widest shadow-sm"
                id="mPos">#--</span>
              <span id="mPercentil"
                class="text-[10px] font-bold text-indigo-500 bg-indigo-50 dark:bg-indigo-900/30 px-2 py-0.5 rounded">Top
                --%</span>
            </div>
            <h2 class="text-2xl font-black text-slate-800 dark:text-white leading-tight break-words" id="mName">Nome
            </h2>
            <p class="text-[10px] font-mono text-slate-400 mt-1 flex items-center gap-1"><i
                class="fa-solid fa-id-card"></i> <span id="mId">--</span></p>
          </div>

          <div
            class="relative h-64 w-full flex-none bg-slate-50/50 dark:bg-[#1a1a1a]/50 rounded-xl border border-slate-100 dark:border-[#262626] flex items-center justify-center p-2">
            <canvas id="radarChart"></canvas>
          </div>
        </div>

        <div
          class="flex-1 flex flex-col gap-4 md:border-l md:border-slate-100 md:dark:border-[#262626] md:pl-6 overflow-y-auto custom-scroll p-1">

          <div
            class="flex flex-col items-center justify-center bg-slate-50 dark:bg-[#1a1a1a] p-3 rounded-xl border border-slate-100 dark:border-slate-700 gap-3">
            <div id="mStatusBadge" class="transform scale-110"></div>
            <div class="flex flex-wrap justify-center gap-2">
              <button onclick="toggleExclusion()" id="btnExclude"
                class="text-[9px] font-bold text-red-500 hover:bg-red-50 px-3 py-1.5 rounded border border-red-200 uppercase transition-colors">Marcar
                Desistente</button>

              <button onclick="editCandidateScore()"
                class="text-[9px] font-bold text-amber-600 hover:bg-amber-50 px-3 py-1.5 rounded border border-amber-200 uppercase transition-colors flex items-center gap-1">
                <i class="fa-solid fa-pen"></i> Editar Nota
              </button>
              <button onclick="toggleTracker()"
                class="text-[9px] font-bold text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800 dark:text-[#a3a3a3] px-3 py-1.5 rounded border border-slate-200 dark:border-slate-700 uppercase transition-colors flex items-center gap-1">
                <i class="fa-solid fa-crosshairs"></i> Fixar
              </button>
              <button onclick="setMyIdentity()"
                class="text-[9px] font-bold text-white bg-indigo-600 hover:bg-indigo-700 px-3 py-1.5 rounded border border-indigo-600 uppercase transition-colors flex items-center gap-1 shadow-md"><i
                  class="fa-solid fa-user-check"></i> Sou Eu
              </button>
            </div>
          </div>
          <div id="gapAnalysis"
            class="bg-indigo-50 dark:bg-indigo-900/20 p-3 rounded-xl border border-indigo-100 dark:border-indigo-800 text-center hidden">
            <p class="text-[9px] font-bold text-indigo-500 uppercase mb-1">An√°lise de Vaga</p>
            <p id="gapText" class="text-xs font-medium text-slate-700 dark:text-[#d4d4d4]"></p>
          </div>

          <div
            class="grid grid-cols-3 gap-0 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden shadow-sm flex-none">
            <div
              class="bg-indigo-50 dark:bg-indigo-900/20 p-3 text-center border-r border-indigo-100 dark:border-indigo-800">
              <p class="text-[9px] font-bold text-indigo-400 uppercase">Final</p>
              <p class="text-xl font-black text-indigo-700 dark:text-indigo-400 leading-none mt-1" id="mTotal">--</p>
            </div>
            <div class="bg-white dark:bg-[#1a1a1a] p-3 text-center border-r border-slate-100 dark:border-slate-700">
              <p class="text-[9px] font-bold text-slate-400 uppercase">Esp.</p>
              <p class="text-sm font-bold text-slate-700 dark:text-[#d4d4d4] leading-none mt-1" id="mEsp">--</p>
            </div>
            <div class="bg-white dark:bg-[#1a1a1a] p-3 text-center">
              <p class="text-[9px] font-bold text-slate-400 uppercase">Disc.</p>
              <p class="text-sm font-bold text-slate-700 dark:text-[#d4d4d4] leading-none mt-1" id="mDisc">--</p>
            </div>
          </div>

          <div class="flex-grow">
            <h4
              class="text-[10px] font-bold text-slate-400 uppercase border-b border-slate-100 dark:border-[#262626] pb-2 mb-3 flex items-center gap-2">
              <i class="fa-solid fa-list-check"></i> Detalhes de Cotas
            </h4>
            <div id="mCotasInfo" class="flex flex-col gap-2"></div>
          </div>

          <div class="grid grid-cols-2 gap-3 mt-auto pt-2">
            <button onclick="shareCandidateResult()"
              class="py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl shadow-lg flex items-center justify-center gap-2 text-xs font-bold uppercase transition-all active:scale-95 hover:shadow-xl">
              <i class="fa-brands fa-whatsapp text-lg"></i> WhatsApp
            </button>
            <button onclick="window.generateShareCard()"
              class="py-3 bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-700 hover:to-indigo-700 text-white rounded-xl shadow-lg flex items-center justify-center gap-2 text-xs font-bold uppercase transition-all active:scale-95 hover:shadow-xl">
              <i class="fa-solid fa-image text-lg"></i> Gerar Card
            </button>
            <div class="col-span-2">
              <button onclick="triggerSniperMode()"
                class="w-full py-3 bg-slate-800 hover:bg-slate-900 dark:bg-slate-700 dark:hover:bg-slate-600 text-white rounded-xl shadow-lg flex items-center justify-center gap-2 text-xs font-bold uppercase transition-all active:scale-95 hover:shadow-xl">
                <i class="fa-solid fa-people-arrows text-lg"></i> Ver Vizinhos
              </button>
            </div>
          </div>
        </div>
      </div>

      <div id="shareCardContainer" class="absolute -top-[9999px] left-0 w-[400px] bg-white p-6 rounded-2xl shadow-none">
        <div class="bg-gradient-to-r from-indigo-600 to-indigo-800 h-2 w-full absolute top-0 left-0"></div>
        <div class="text-center mt-4">
          <h2 class="text-2xl font-black text-slate-800 mb-1" id="scName">NOME</h2>
          <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold uppercase"
            id="scPos">POSI√á√ÉO</span>
        </div>
        <div class="mt-6 flex justify-center gap-4">
          <div class="text-center">
            <p class="text-xs text-slate-400 uppercase font-bold">Nota Final</p>
            <p class="text-3xl font-black text-indigo-600" id="scTotal">0.00</p>
          </div>
        </div>
        <div class="mt-6 p-3 bg-slate-50 rounded-xl text-center border border-slate-100">
          <p class="text-sm font-bold text-slate-600" id="scStatus">STATUS</p>
        </div>
        <p class="text-[10px] text-slate-400 text-center mt-6">Gerado pelo Painel CNU Bloco 7</p>
      </div>
    </div>

    <div id="helpModal" class="fixed inset-0 z-[130] hidden flex items-center justify-center pointer-events-none p-4">
      <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity opacity-0 pointer-events-auto"
        onclick="toggleHelp()" id="helpOverlay"></div>
      <div id="helpContent"
        class="glass-modal w-full max-w-2xl bg-white dark:bg-[#121212] rounded-2xl shadow-2xl transform scale-95 opacity-0 transition-all duration-300 pointer-events-auto flex flex-col max-h-[85vh] overflow-hidden relative">

        <div
          class="p-5 border-b border-slate-100 dark:border-[#262626] flex justify-between items-center bg-slate-50/50 dark:bg-[#1a1a1a]/50">
          <h3 class="text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2">
            <i class="fa-solid fa-circle-question text-indigo-500"></i> Como usar o Painel
          </h3>
          <button onclick="toggleHelp()"
            class="h-8 w-8 rounded-full bg-slate-200 dark:bg-[#262626] text-slate-500 hover:text-slate-800 flex items-center justify-center transition-colors"><i
              class="fa-solid fa-times"></i></button>
        </div>

        <div class="overflow-y-auto p-6 space-y-8 custom-scroll">

          <section>
            <h4
              class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4 border-b border-slate-100 dark:border-[#262626] pb-2 flex items-center gap-2">
              <i class="fa-solid fa-book-open"></i> Guia R√°pido
            </h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="p-3 bg-slate-50 dark:bg-[#1a1a1a] rounded-lg border border-slate-100 dark:border-[#262626]">
                <h5 class="font-bold text-indigo-600 dark:text-indigo-400 text-sm mb-1"><i
                    class="fa-solid fa-user-tag mr-1"></i> Identidade</h5>
                <p class="text-xs text-slate-500 dark:text-[#a3a3a3]">Localize seu nome na lista e clique no bot√£o
                  <strong>"Sou Eu"</strong> dentro do modal de detalhes. Isso personaliza todo o painel para voc√™.
                </p>
              </div>
              <div class="p-3 bg-slate-50 dark:bg-[#1a1a1a] rounded-lg border border-slate-100 dark:border-[#262626]">
                <h5 class="font-bold text-emerald-600 dark:text-emerald-400 text-sm mb-1"><i
                    class="fa-solid fa-calculator mr-1"></i> Simula√ß√£o</h5>
                <p class="text-xs text-slate-500 dark:text-[#a3a3a3]">O modo de simula√ß√£o permite <strong>alterar sua
                    nota</strong> ou <strong>editar o n√∫mero de vagas</strong>. As altera√ß√µes s√£o refletidas em tempo
                  real na lista, reordenando os classificados para que voc√™ veja exatamente onde ficaria.</p>
              </div>
              <div class="p-3 bg-slate-50 dark:bg-[#1a1a1a] rounded-lg border border-slate-100 dark:border-[#262626]">
                <h5 class="font-bold text-fuchsia-600 dark:text-fuchsia-400 text-sm mb-1"><i
                    class="fa-solid fa-scale-balanced mr-1"></i> Compara√ß√£o</h5>
                <p class="text-xs text-slate-500 dark:text-[#a3a3a3]">Ative o <strong>Modo Compara√ß√£o</strong>,
                  selecione 2 candidatos e veja um gr√°fico comparativo detalhado das notas por disciplina.</p>
              </div>
              <div class="p-3 bg-slate-50 dark:bg-[#1a1a1a] rounded-lg border border-slate-100 dark:border-[#262626]">
                <h5 class="font-bold text-orange-600 dark:text-orange-400 text-sm mb-1"><i
                    class="fa-solid fa-wand-magic-sparkles mr-1"></i> IA Gemini</h5>
                <p class="text-xs text-slate-500 dark:text-[#a3a3a3]">Use o assistente de IA para perguntar coisas como
                  "Qual a nota de corte para PCD?" ou "Minha nota √© suficiente?".</p>
              </div>
            </div>
          </section>

          <section>
            <h4
              class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4 border-b border-slate-100 dark:border-[#262626] pb-2 flex items-center gap-2">
              <i class="fa-solid fa-lightbulb"></i> Dicas de Usabilidade
            </h4>
            <ul class="list-disc pl-5 text-xs text-slate-600 dark:text-[#a3a3a3] space-y-2">
              <li>Use o filtro <strong>"Meu Resultado"</strong> para focar apenas na sua posi√ß√£o.</li>
              <li>Clique nos cabe√ßalhos da tabela (ex: "Nota Final") para ordenar.</li>
              <li>No celular, deslize a tabela horizontalmente para ver todas as colunas.</li>
              <li>O tema <strong>Pitch Black</strong> economiza bateria em telas OLED.</li>
            </ul>
          </section>

          <section>
            <h4
              class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4 border-b border-slate-100 dark:border-[#262626] pb-2 flex items-center gap-2">
              <i class="fa-solid fa-palette"></i> Legendas e Cores
            </h4>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div class="flex items-start gap-3">
                <span class="pill st-vaga flex-none">VAGA</span>
                <p class="text-xs text-slate-600 dark:text-[#d4d4d4]">Classificado dentro das vagas imediatas.</p>
              </div>
              <div class="flex items-start gap-3">
                <span class="pill st-cr flex-none">CR</span>
                <p class="text-xs text-slate-600 dark:text-[#d4d4d4]">Cadastro de Reserva (aguardando convoca√ß√£o).</p>
              </div>
              <div class="flex items-start gap-3">
                <span class="badge bg-fuchsia-100 text-fuchsia-700 border-fuchsia-200 font-bold flex-none text-[9px]"><i
                    class="fa-solid fa-arrow-turn-up mr-1"></i>Vaga AC</span>
                <p class="text-xs text-slate-600 dark:text-[#d4d4d4]"><strong>Realoca√ß√£o:</strong> Candidato de Cota que
                  teve nota para passar na Ampla Concorr√™ncia.</p>
              </div>

            </div>
          </section>

          <section>
            <h4
              class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4 border-b border-slate-100 dark:border-[#262626] pb-2 flex items-center gap-2">
              <i class="fa-solid fa-magnifying-glass-chart"></i> Ferramentas Avan√ßadas
            </h4>
            <div class="space-y-4">
              <div class="flex gap-4 group">
                <div
                  class="h-10 w-10 flex-none rounded-lg bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 flex items-center justify-center group-hover:scale-110 transition-transform">
                  <i class="fa-solid fa-chart-pie"></i>
                </div>
                <div>
                  <h5 class="text-sm font-bold text-slate-800 dark:text-white">Radar de Desempenho</h5>
                  <p class="text-xs text-slate-500 mt-1">Ao clicar em um candidato, veja o gr√°fico (Radar) que compara o
                    equil√≠brio entre as notas Espec√≠fica, Discursiva e Geral.</p>
                </div>
              </div>
              <div class="flex gap-4 group">
                <div
                  class="h-10 w-10 flex-none rounded-lg bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 flex items-center justify-center group-hover:scale-110 transition-transform">
                  <i class="fa-solid fa-crosshairs"></i>
                </div>
                <div>
                  <h5 class="text-sm font-bold text-slate-800 dark:text-white">Fixar Candidato</h5>
                  <p class="text-xs text-slate-500 mt-1">Nos detalhes, clique em <strong>Fixar</strong>. Uma barra fixa
                    aparecer√° no rodap√© mostrando a nota do candidato enquanto voc√™ rola a lista para comparar.</p>
                </div>
              </div>
              <div class="flex gap-4 group">
                <div
                  class="h-10 w-10 flex-none rounded-lg bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 flex items-center justify-center group-hover:scale-110 transition-transform">
                  <i class="fa-solid fa-check-double"></i>
                </div>
                <div>
                  <h5 class="text-sm font-bold text-slate-800 dark:text-white">Modo Compara√ß√£o</h5>
                  <p class="text-xs text-slate-500 mt-1">Ative "Comparar" no menu. Selecione dois candidatos para ver um
                    gr√°fico "x1" lado a lado.</p>
                </div>
              </div>
              <div class="flex gap-4 group">
                <div
                  class="h-10 w-10 flex-none rounded-lg bg-slate-100 dark:bg-[#1a1a1a] text-slate-600 dark:text-[#a3a3a3] flex items-center justify-center group-hover:scale-110 transition-transform">
                  <i class="fa-solid fa-sliders"></i>
                </div>
                <div>
                  <h5 class="text-sm font-bold text-slate-800 dark:text-white">Simulador de Absten√ß√£o</h5>
                  <p class="text-xs text-slate-500 mt-1">No menu de configura√ß√µes (<i
                      class="fa-solid fa-gear text-[10px]"></i>), defina uma % de desist√™ncia para recalcular a fila e
                    ver se voc√™ entra.</p>
                </div>
              </div>
            </div>
          </section>
        </div>

        <div class="p-5 border-t border-slate-100 dark:border-[#262626] bg-slate-50 dark:bg-[#0a0a0a] text-center">
          <button onclick="toggleHelp()"
            class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-xl shadow-lg transition-transform active:scale-95 text-xs uppercase">Entendi,
            vamos l√°!</button>

        </div>
      </div>
    </div>

  </div>
  <div id="stickyTracker"
    class="fixed bottom-0 left-0 w-full bg-white/95 dark:bg-[#121212]/95 backdrop-blur-md border-t border-slate-200 dark:border-[#333] shadow-[0_-4px_20px_rgba(0,0,0,0.15)] z-[90] transform translate-y-full transition-transform duration-300 flex items-center justify-between px-4 py-3 lg:px-8 lg:py-4">
    <div class="flex items-center gap-3 sm:gap-4">
      <div
        class="h-10 w-10 flex-none rounded-full bg-indigo-100 dark:bg-indigo-900/50 flex items-center justify-center text-indigo-600 dark:text-indigo-400 shadow-sm animate-pulse-slow">
        <i class="fa-solid fa-crosshairs text-lg"></i>
      </div>
      <div class="min-w-0">
        <p class="text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-0.5">Rastreando Candidato</p>
        <div class="flex items-baseline gap-2">
          <h3 class="font-bold text-sm sm:text-base text-slate-800 dark:text-white truncate max-w-[150px] sm:max-w-xs"
            id="stName">Nome do Candidato</h3>
          <span
            class="text-xs font-mono text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-900/30 px-1.5 rounded font-bold"
            id="stPos">#--</span>
        </div>
      </div>
    </div>

    <div class="flex items-center gap-4 sm:gap-6">
      <div class="hidden sm:flex items-center gap-4 border-r border-slate-200 dark:border-slate-700 pr-6">
        <div class="text-right">
          <p class="text-[9px] font-bold text-slate-400 uppercase">Nota Final</p>
          <p class="font-mono font-bold text-lg text-slate-700 dark:text-[#d4d4d4] leading-none" id="stScore">--</p>
        </div>
        <div class="text-right">
          <p class="text-[9px] font-bold text-slate-400 uppercase">Situa√ß√£o</p>
          <p class="font-bold text-xs text-slate-700 dark:text-[#d4d4d4] leading-none mt-1" id="stStatus">--</p>
        </div>
      </div>

      <button onclick="closeTracker()"
        class="h-9 w-9 flex items-center justify-center hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full text-slate-400 hover:text-red-500 transition-colors"
        title="Parar de Rastrear">
        <i class="fa-solid fa-times text-lg"></i>
      </button>
    </div>
  </div>



  <!-- EDIT SCORE MODAL -->
  <div id="editScoreModal" class="fixed inset-0 z-[110] hidden pointer-events-none">
    <!-- Backdrop -->
    <div id="editScoreOverlay"
      class="absolute inset-0 bg-black/60 dark:bg-black/80 backdrop-blur-sm opacity-0 transition-opacity duration-300"
      onclick="closeEditModal()"></div>

    <!-- Content -->
    <div id="editScoreContent"
      class="absolute inset-0 m-auto max-w-sm w-full h-fit p-6 bg-white dark:bg-[#121212] rounded-2xl shadow-2xl transform scale-95 opacity-0 transition-all duration-300 border border-slate-100 dark:border-[#262626]">

      <div class="flex items-center justify-between mb-6">
        <h3 class="text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2">
          <i class="fa-solid fa-sliders text-indigo-500"></i> Simular Notas
        </h3>
        <button onclick="closeEditModal()" class="text-slate-400 hover:text-red-500 transition-colors">
          <i class="fa-solid fa-times text-lg"></i>
        </button>
      </div>

      <div class="space-y-4">
        <div>
          <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Conhecimentos Gerais</label>
          <input type="number" id="input_geral" step="1"
            class="w-full bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-[#333] rounded-lg px-4 py-3 text-slate-800 dark:text-white font-mono focus:ring-2 focus:ring-indigo-500 outline-none transition-all">
        </div>
        <div>
          <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Conhecimentos Espec√≠ficos</label>
          <input type="number" id="input_esp" step="2"
            class="w-full bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-[#333] rounded-lg px-4 py-3 text-slate-800 dark:text-white font-mono focus:ring-2 focus:ring-indigo-500 outline-none transition-all">
        </div>
        <div>
          <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Discursiva</label>
          <input type="number" id="input_disc" step="0.01"
            class="w-full bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-[#333] rounded-lg px-4 py-3 text-slate-800 dark:text-white font-mono focus:ring-2 focus:ring-indigo-500 outline-none transition-all">
        </div>
        <div>
          <label class="block text-xs font-bold text-slate-500 uppercase mb-1">T√≠tulos</label>
          <input type="number" id="input_tit" step="0.1"
            class="w-full bg-slate-50 dark:bg-[#1a1a1a] border border-slate-200 dark:border-[#333] rounded-lg px-4 py-3 text-slate-800 dark:text-white font-mono focus:ring-2 focus:ring-indigo-500 outline-none transition-all">
        </div>
      </div>

      <div class="mt-8 flex gap-3">
        <button onclick="closeEditModal()"
          class="flex-1 py-3 px-4 rounded-xl text-slate-500 hover:bg-slate-100 dark:hover:bg-[#1a1a1a] font-bold text-sm transition-colors">
          Cancelar
        </button>
        <button onclick="confirmSimulation()"
          class="flex-1 py-3 px-4 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white font-bold text-sm shadow-lg shadow-indigo-500/20 transform active:scale-95 transition-all">
          Salvar Simula√ß√£o
        </button>
      </div>
    </div>
  </div>

  <!-- TOAST CONTAINER -->
  <!-- STATISTICS MODAL -->
  <div id="statsModal" class="fixed inset-0 z-[130] flex items-center justify-center hidden pointer-events-none">
    <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity duration-300 opacity-0"
      onclick="window.closeStatsModal()" id="statsOverlay"></div>
    <div id="statsContent"
      class="glass-modal w-full max-w-5xl bg-white dark:bg-[#121212] rounded-2xl shadow-2xl transform scale-95 opacity-0 transition-all duration-300 pointer-events-auto flex flex-col max-h-[90vh] overflow-hidden relative m-4">

      <div
        class="p-5 border-b border-slate-100 dark:border-[#262626] flex justify-between items-center bg-slate-50/50 dark:bg-[#1a1a1a]/50">
        <h3 class="text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2">
          <i class="fa-solid fa-chart-pie text-indigo-500"></i> Dashboard Estat√≠stico
        </h3>
        <button onclick="window.closeStatsModal()"
          class="h-8 w-8 rounded-full bg-slate-200 dark:bg-[#262626] text-slate-500 hover:text-slate-800 flex items-center justify-center transition-colors">
          <i class="fa-solid fa-times"></i>
        </button>
      </div>

      <div class="overflow-y-auto p-6 custom-scroll">
        <!-- KPI CARDS -->
        <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
          <div class="p-4 bg-slate-50 dark:bg-[#1a1a1a] rounded-xl border border-slate-100 dark:border-[#262626]">
            <p class="text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-1">Total Candidatos</p>
            <p class="text-2xl font-black text-slate-800 dark:text-white" id="statTotal">-</p>
          </div>
          <div class="p-4 bg-slate-50 dark:bg-[#1a1a1a] rounded-xl border border-slate-100 dark:border-[#262626]">
            <p class="text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-1">M√©dia Geral</p>
            <p class="text-2xl font-black text-indigo-600 dark:text-indigo-400" id="statAvg">-</p>
          </div>
          <div class="p-4 bg-slate-50 dark:bg-[#1a1a1a] rounded-xl border border-slate-100 dark:border-[#262626]">
            <p class="text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-1">Nota Corte Vaga AC</p>
            <p class="text-2xl font-black text-emerald-600 dark:text-emerald-400" id="statCutVaga">-</p>
          </div>
          <div class="p-4 bg-slate-50 dark:bg-[#1a1a1a] rounded-xl border border-slate-100 dark:border-[#262626]">
            <p class="text-[10px] text-slate-400 uppercase font-bold tracking-widest mb-1">Nota Corte CR AC</p>
            <p class="text-2xl font-black text-sky-600 dark:text-sky-400" id="statCutCR">-</p>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
          <!-- Distribution Chart -->
          <div
            class="p-5 bg-white dark:bg-[#1a1a1a] rounded-xl border border-slate-100 dark:border-[#262626] shadow-sm">
            <h4 class="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4">Distribui√ß√£o por Status</h4>
            <div class="h-64">
              <canvas id="statPieChart"></canvas>
            </div>
          </div>
          <!-- Average Comparison Chart -->
          <div
            class="p-5 bg-white dark:bg-[#1a1a1a] rounded-xl border border-slate-100 dark:border-[#262626] shadow-sm">
            <h4 class="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4">M√©dias por Disciplina (AC vs
              Cotas)</h4>
            <div class="h-64">
              <canvas id="statBarChart"></canvas>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- TOP 5 -->
          <div>
            <h4 class="text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-widest mb-3"><i
                class="fa-solid fa-arrow-trend-up mr-2"></i>Top 5 Notas (Geral)</h4>
            <div class="overflow-x-auto rounded-lg border border-slate-100 dark:border-[#262626]">
              <table class="w-full text-left text-xs">
                <thead class="bg-slate-50 dark:bg-[#262626] text-slate-500 font-semibold">
                  <tr>
                    <th class="p-3">Pos</th>
                    <th class="p-3">Nome</th>
                    <th class="p-3 text-right">Nota</th>
                  </tr>
                </thead>
                <tbody id="statTopBody" class="divide-y divide-slate-50 dark:divide-slate-800"></tbody>
              </table>
            </div>
          </div>
          <!-- Cotas Breakdown -->
          <div>
            <h4 class="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-3"><i
                class="fa-solid fa-users mr-2"></i>Inscritos por Cota</h4>
            <div class="overflow-x-auto rounded-lg border border-slate-100 dark:border-[#262626]">
              <table class="w-full text-left text-xs">
                <thead class="bg-slate-50 dark:bg-[#262626] text-slate-500 font-semibold">
                  <tr>
                    <th class="p-3">Cota</th>
                    <th class="p-3 text-right">Total</th>
                    <th class="p-3 text-right">%</th>
                  </tr>
                </thead>
                <tbody id="statCotasBody" class="divide-y divide-slate-50 dark:divide-slate-800"></tbody>
              </table>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <div id="toastContainer" class="fixed top-4 right-4 z-[120] flex flex-col gap-2 pointer-events-none"></div>

  <!-- JSON DATA: COLE O JSON DENTRO DO COLCHETE ABAIXO (MANTENHA NO FINAL DO ARQUIVO) -->
  <!-- DATA SCRIPT (No CORS issues) -->
  <script src="js/database.js"></script>
  <!-- LOGIC SCRIPT -->
  <script src="js/script.js"></script>
</body>

</html>